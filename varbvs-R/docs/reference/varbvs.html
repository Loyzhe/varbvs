<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit variable selection model using variational approximation methods. — varbvs • varbvs</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">varbvs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/pcarbo/varbvs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit variable selection model using variational approximation methods.</h1>
    </div>

    
    <p>Compute fully-factorized variational approximation for
  Bayesian variable selection in linear (family = gaussian) or logistic
  regression (family = binomial). More precisely, find the "best"
  fully-factorized approximation to the posterior distribution of the
  coefficients, with spike-and-slab priors on the coefficients. By
  "best", we mean the approximating distribution that locally minimizes
  the Kullback-Leibler divergence between the approximating distribution
  and the exact posterior.</p>
    

    <pre><span class='fu'>varbvs</span> (<span class='no'>X</span>, <span class='no'>Z</span>, <span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"gaussian"</span>,<span class='st'>"binomial"</span>), <span class='no'>sigma</span>, <span class='no'>sa</span>,
          <span class='no'>logodds</span>, <span class='no'>alpha</span>, <span class='no'>mu</span>, <span class='no'>eta</span>, <span class='no'>update.sigma</span>, <span class='no'>update.sa</span>,
          <span class='no'>optimize.eta</span>, <span class='no'>initialize.params</span>, <span class='kw'>nr</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>sa0</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>n0</span> <span class='kw'>=</span> <span class='fl'>0</span>,
          <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-4</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>1e4</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>n x p input matrix, where n is the number of samples,
           and p is the number of variables. X cannot be sparse,
           and cannot have any missing values (NA).</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>n x m covariate data matrix, where m is the number of
           covariates. Do not supply an intercept as a covariate
           (i.e., a column of ones), because an intercept is
           automatically included in the regression model. For no
	   covariates, set <code>Z = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector of length n containing observations of binary
          (<code>family = "binomial"</code>) or continuous (<code>family =
          "gaussian"</code>) outcome. For a binary outcome, all entries
          of y must be 0 or 1.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>"gaussian" for linear regression model, or "binomial"
                for logistic regression model.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>Candidate settings for the residual variance
  parameter. Must be of the same length as inputs sa and logodds (or
  have length equal to the number of columns of logodds). Only used for
  linear regression, and will generate an error if <code>family =
  "binomial"</code>. If missing, residual variance parameter is automatically
  fitted to data by computing approximate maximum-likelihood (ML)
  estimate.</p></td>
    </tr>
    <tr>
      <th>sa</th>
      <td><p>Hyperparameter sa is the prior variance of regression
    coefficients for variables that are included in the model. This
    prior variance is always scaled by sigma (for logistic regression,
    we take sigma = 1). This input specifies the candidate settings for
    sa, of the same length as inputs sigma and logodds (or have length
    equal to the number of columns of logodds). If missing, prior
    variance is automatically fitted to data by compute approximate
    maximum (ML) estimates, or maximum a posteriori estimates when
    <code>n0 &gt; 0</code> and <code>sa0 &gt; 0</code>.</p></td>
    </tr>
    <tr>
      <th>logodds</th>
      <td><p>Hyperparameter logodds is the prior log-odds that a
    variable is included in the regression model; it is defined as
    \(logodds = log10(q/(1-q)),\) where q is the prior probability
    that a variable is included in the regression model. Note that we
    use the base-10 logarithm instead of the natural logarithm because
    it is usually more natural to specify prior log-odds settings in
    this way. The prior log-odds may also be specified separately for
    each variable, which is useful is there is prior information about
    which variables are most relevant to the outcome. This is
    accomplished by setting logodds to a p x ns matrix, where p is the
    number of variables, and ns is the number of hyperparameter
    settings. Note it is not possible to fit the logodds parameter; if
    logodds input is not provided as input, then it is set to the
    default value when sa and sigma are missing, and otherwise an error
    is generated.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Good initial estimate for the variational parameter alpha
    for each hyperparameter setting. Either missing, or a p x ns matrix,
    where p is the number of variables, and ns is the number of
    hyperparameter settings.</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>Good initial estimate for the variational parameter mu for
    each hyperparameter setting. Either missing, or a p x ns matrix,
    where p is the number of variables, and ns is the number of
    hyperparameter settings.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p>Good initial estimate of the additional free parameters
    specifying the variational approximation to the logistic regression
    factors. Either missing, or an n x ns matrix, where n is the number
    of samples, and ns is the number of hyperparameter settings.</p></td>
    </tr>
    <tr>
      <th>update.sigma</th>
      <td><p>Setting this to TRUE ensures that sigma is always
    fitted to data, in which case input vector sigma is used to provide
    initial estimates.</p></td>
    </tr>
    <tr>
      <th>update.sa</th>
      <td><p>Setting this to TRUE ensures that sa is always fitted
    to data, in which case input vector sa is used to provide initial
    estimates.</p></td>
    </tr>
    <tr>
      <th>optimize.eta</th>
      <td><p>When optimize.eta = TRUE, eta is fitted to the
    data during the inner loop coordinate ascent updates, even when good
    estimates of eta are provided as input.</p></td>
    </tr>
    <tr>
      <th>initialize.params</th>
      <td><p>If TRUE, the initialization stage of the
    variational inference algorithm (see below) will be skipped, which
    saves computation time for large data sets.</p></td>
    </tr>
    <tr>
      <th>nr</th>
      <td><p>Number of samples of "model PVE" to draw from posterior.</p></td>
    </tr>
    <tr>
      <th>sa0</th>
      <td><p>Scale parameter for a scaled inverse chi-square prior on
    hyperparameter sa. Must be &gt;= 0.</p></td>
    </tr>
    <tr>
      <th>n0</th>
      <td><p>Number of degrees of freedom for a scaled inverse chi-square
    prior on hyperparameter sa. Must be &gt;= 0.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Convergence tolerance for inner loop.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of inner loop iterations.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If verbose = TRUE, print progress of algorithm to
    console.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="regression-models"><a class="anchor" href="#regression-models"></a>Regression models</h2>

    <p>Two types of outcomes (y) are modeled: (1) a continuous outcome,
    also a "quantitative trait" in the genetics literature; or (2) a
    binary outcome with possible values 0 and 1. For the former, set
    <code>family = "gaussian"</code>, in which case, the outcome is
    i.i.d. normal with mean \(u0 + Z*u + X*b\) and variance sigma, in
    which u and b are vectors of regresion coefficients, and u0 is the
    intercept. In the second case, we use logistic regression to model
    the outcome, in which the probability that y = 1 is equal to
    \(sigmoid(u0 + Z*u + X*b).\) See <code>help(sigmoid)</code> for a
    description of the sigmoid function. Note that the regression always
    includes an intercept term (u0).</p>
    
    <h2 class="hasAnchor" id="co-ordinate-ascent-optimization-procedure"><a class="anchor" href="#co-ordinate-ascent-optimization-procedure"></a>Co-ordinate ascent optimization procedure</h2>

    <p>For both regression models, the fitting procedure consists of an inner
    loop and an outer loop. The outer loop iterates over each of the
    hyperparameter settings (sa, sigma and logodds). Given a setting of
    the hyperparameters, the inner loop cycles through coordinate ascent
    updates to tighten the lower bound on the marginal likelihood,
    \(Pr(Y | X, sigma, sa, logodds)\). The inner loop coordinate
    ascent updates terminate when either (1) the maximum number of inner
    loop iterations is reached, as specified by <code>maxiter</code>, or (2)
    the maximum difference between the estimated posterior inclusion
    probabilities is less than <code>tol</code>.</p>
<p>To provide a more accurate variational approximation of the posterior
    distribution, by default the fitting procedure has two stages. In the
    first stage, the entire fitting procedure is run to completion, and the
    variational parameters (alpha, mu, s, eta) corresponding to the maximum
    lower bound are then used to initialize the coordinate ascent updates
    in a second stage. Although this has the effect of doubling the
    computation time (in the worst case), the final posterior estimates
    tend to be more accurate with this two-stage fitting procedure.</p>
    
    <h2 class="hasAnchor" id="variational-approximation"><a class="anchor" href="#variational-approximation"></a>Variational approximation</h2>

    <p>Outputs alpha, mu and s specify the approximate posterior distribution
    of the regression coefficients. Each of these outputs is a p x ns
    matrix. For the ith hyperparameter setting, alpha[,i] is the
    variational estimate of the posterior inclusion probability (PIP)
    for each variable; mu[,i] is the variational estimate of the
    posterior mean coefficient given that it is included in the model;
    and s[,i] is the estimated posterior variance of the coefficient
    given that it is included in the model. These are also the
    quantities that are optimized as part of the inner loop coordinate
    ascent updates. An additional free parameter, eta, is needed for
    fast computation with the logistic regression model <code>(family =
    "binomial")</code>. The fitted value of eta is returned as an n x ns
    matrix.</p>
<p>Note that special care is required for interpreting the results of
    the variational approximation with the logistic regression model. In
    particular, interpretation of the individual estimates of the
    regression coefficients (e.g., the posterior mean estimates
    <code>fit$mu</code>) is not straightforward due to the additional
    approximation introduced on the individual nonlinear factors in the
    likelihood. As a general guideline, only the relative magnitudes of
    the coefficients are meaningful.</p>
    
    <h2 class="hasAnchor" id="averaging-over-hyperparameter-settings"><a class="anchor" href="#averaging-over-hyperparameter-settings"></a>Averaging over hyperparameter settings</h2>

    <p>In many settings, it is good practice to account for uncertainty in
    the hyperparameters when reporting final posterior quantities. For
    example, hyperparameter sa is often estimated with a high degree of
    uncertainty when only a few variables are included in the model.
    Provided that (1) the hyperparameter settings sigma, sa and logodds
    adequately represent the space of possible hyperparameter settings
    with high posterior mass, (2) the hyperparameter settings are drawn
    from the same distribution as the prior, and (3) the
    fully-factorized variational approximation closely approximates the
    true posterior distribution, then final posterior quantities can be
    calculated by using logw as (unnormalized) log-marginal
    probabilities.</p>
<p>Even when conditions (1), (2) and/or (3) are not satisfied, this can
    approach can still often yield reasonable estimates of averaged
    posterior quantities. The examples below demonstrate how final
    posterior quantities are reported by function
    <code><a href='summary.varbvs.html'>summary.varbvs</a></code> (see <code>help(summary.varbvs)</code> for
    more details). To account for discrepancies between the prior on
    (sigma,sa,logodds) and the sampling density used to draw candidate
    settings of the hyperparameters, adjust the log-probabilities by
    setting <code>fit$logw &lt;- fit$logw + logp/logq</code>, where logp is the
    log-density of the prior distribution, and logq is the log-density
    of the sampling distribution. (This is importance sampling; see, for
    example, R. M. Neal, Annealed importance sampling, <em>Statistics
      and Computing</em>, 2001.)</p>
    
    <h2 class="hasAnchor" id="prior-on-proportion-of-variance-explained"><a class="anchor" href="#prior-on-proportion-of-variance-explained"></a>Prior on proportion of variance explained</h2>

    
    <p>Specifying the prior variance of the regression coefficients (sa) can
  be difficult, which is why we have included the option of fitting this
  hyperparameter to the data (see input argument <code>update.sa</code>
  above). However, in many settings, especially when a small number of
  variables are included in the regression model, it is preferrable to
  average over candidate settings of sa instead of fitting sa to the
  data. To choose a set of candidate settings for sa, we have advocated
  for setting sa indirectly through a prior estimate of the proportion
  of variance in the outcome explained by the variables (abbreviated as
  PVE), since it is often more natural to specify the PVE rather than
  the prior variance (see references below). This is technically only
  suitable or the linear regression model (<code>family = "gaussian"</code>),
  but could potentially be used for the linear regression model in an
  approximate way.</p>
<p>For example, one could approximate a uniform prior on the PVE by
  drawing the PVE uniformly between 0 and 1, additionally specifying
  candidate settings for the prior log-odds, then computing the prior
  variance (sa) as follows:</p><pre>sx &lt;- sum(var1.cols(X))
sa &lt;- PVE/(1-PVE)/(sigmoid(log(10)*logodds)*sx)</pre><p>Note that this calculation will yield <code>sa = 0</code> when <code>PVE =
  0</code>, and <code>sa = Inf</code> when <code>PVE = 1</code>.
    Also, bear in mind that if there are additional covariates (Z)
  included in the linear regression model that explain variance in Y,
  then it will usually make more sense to first remove the linear
  effects of these covariates before performing this calculation. The
  PVE would then represent the prior proportion of variance in the
  residuals of Y that are explained by the candidate variables. For an
  example of how to do this, see the code for function <code>varbvs</code>, in
  file varbvs.R, under "preprocessing steps". Alternatively, one could
  include the matrix Z in the calculation above, taking care to ensure
  that the covariates are included in the model with probability 1.</p>
    
    <h2 class="hasAnchor" id="memory-requirements"><a class="anchor" href="#memory-requirements"></a>Memory requirements</h2>

    <p>Finally, we point out that the optimization procedures were
    carefully designed so that they can be applied to very large data
    sets; to date, this code has been tested on data sets with &gt;500,000
    variables and &gt;10,000 samples. An important limiting factor is the
    ability to store the data matrix X in memory. To reduce memory
    requirements, in the MATLAB interface we require that X be single
    precision, but this option is not available in R. Additionally, we
    mostly avoid generating intermediate products that are of the same
    size as X. Only one such intermediate product is generated when
    <code>family = "gaussian"</code>, and none for <code>family = "binomial"</code>.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>c("varbvs","list")</code>.</p>
<p></p>
<dt>family</dt><dd><p>Either "gaussian" or "binomial".</p></dd>

  <dt>n</dt><dd><p>Number of data samples used to fit model.</p></dd>

  <dt>ncov</dt><dd><p>Number of covariates (columns of Z).</p></dd>

  <dt>sigma</dt><dd><p>Settings for sigma (family = "gaussian" only).</p></dd>

  <dt>sa</dt><dd><p>Settings for prior variance parameter.</p></dd>

  <dt>logodds</dt><dd><p>Prior log-odds settings.</p></dd>

  <dt>prior.same</dt><dd><p>TRUE if prior is identical for all variables. When
        logodds is a p x ns matrix, <code>prior.same = FALSE</code>.</p></dd>

  <dt>sa0</dt><dd><p>Scale parameter for prior on hyperparameter sa.</p></dd>

  <dt>n0</dt><dd><p>Degrees of freedom for prior on hyperparameter sa.</p></dd>

  <dt>update.sigma</dt><dd><p>If TRUE, sigma was fit to data for each setting of
    prior logodds (<code>family = "gaussian"</code> only).</p></dd>

  <dt>update.sa</dt><dd><p>If TRUE, sa was fit to data for each setting of prior
  logodds.</p></dd>

  <dt>logw</dt><dd><p>An array with ns elements, in which <code>logw[i]</code> is the
    variational lower bound on the marginal log-likelihood for setting i
    of the hyperparameters.</p></dd>

  <dt>alpha</dt><dd><p>Variational estimates of posterior inclusion
    probabilities for each hyperparameter setting.</p></dd>

  <dt>mu</dt><dd><p>Variational estimates of posterior mean coefficients for
    each hyperparameter setting.</p></dd>

  <dt>s</dt><dd><p>Variational estimates of posterior variances for each
    hyperparameter setting.</p></dd>

  <dt>mu.cov</dt><dd><p>Posterior mean regression coefficients for covariates,
  including intercept, for each hyperparameter setting.</p></dd>
  
  <dt>eta</dt><dd><p>Additional variational parameters for <code>family =
    "binomial"</code> only.</p></dd>
  
  <dt>optimize.eta</dt><dd><p>If TRUE, eta was fit to data (<code>family =
  "binomial"</code> only).</p></dd>

  <dt>pve</dt><dd><p>For each hyperparameter setting, and for each variable,
    mean estimate of the proportion of variance in outcome explained
    conditioned on variable being included in the model (<code>family =
    "gaussian"</code> only).</p></dd>
    
  <dt>model.pve</dt><dd><p>Samples drawn from posterior distribution giving
  estimates of proportion of variance in outcome (y) explained by fitted
  variable selection model. This is for <code>family = "gaussian"</code>
  only). To obtain the posterior mean estimate of the proportion of
  variance explained (PVE), for example, simply type
  <code>mean(fit$model.pve)</code>.</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>P. Carbonetto and M. Stephens (2012). Scalable variational inference
  for Bayesian variable selection in regression, and its accuracy in
  genetic association studies. <em>Bayesian Analysis</em> <b>7</b>,
  73--108.</p>
<p>Y. Guan and M. Stephens (2011). Bayesian variable selection regression
  for genome-wide association studies and other large-scale
  problems. <em>Annals of Applied Statistics</em> <b>5</b>, 1780--1815.</p>
<p>X. Zhou, P. Carbonetto and M. Stephens (2013). Polygenic modeling with
  Bayesian sparse linear mixed models. <em>PLoS Genetics</em> <b>9</b>,
  e1003264.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>summary.varbvs</code>, <code>varbvscoefcred</code>, <code>varbvspve</code>,
  <code>varbvsnorm</code>, <code>varbvsbin</code>, <code>varbvsbinz</code>,
  <code>normalizelogweights</code>, <code>varbvs-internal</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># LINEAR REGRESSION EXAMPLE</span>
<span class='co'># -------------------------</span>
<span class='co'># Data are 200 uncorrelated ("unlinked") single nucleotide polymorphisms</span>
<span class='co'># (SNPs) with simulated genotypes, in which the first 20 of them have an</span>
<span class='co'># effect on the outcome. Also generate data for 3 covariates.</span>
<span class='no'>maf</span> <span class='kw'>&lt;-</span> <span class='fl'>0.05</span> + <span class='fl'>0.45</span>*<span class='fu'>runif</span>(<span class='fl'>200</span>)
<span class='no'>X</span>   <span class='kw'>&lt;-</span> (<span class='fu'>runif</span>(<span class='fl'>400</span>*<span class='fl'>200</span>) <span class='kw'>&lt;</span> <span class='no'>maf</span>) + (<span class='fu'>runif</span>(<span class='fl'>400</span>*<span class='fl'>200</span>) <span class='kw'>&lt;</span> <span class='no'>maf</span>)
<span class='no'>X</span>   <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>as.double</span>(<span class='no'>X</span>),<span class='fl'>400</span>,<span class='fl'>200</span>,<span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>Z</span>   <span class='kw'>&lt;-</span> <span class='fu'><a href='rand.html'>randn</a></span>(<span class='fl'>400</span>,<span class='fl'>3</span>)

<span class='co'># Generate the ground-truth regression coefficients for the variables</span>
<span class='co'># (X) and additional 3 covariates (Z). Adjust the QTL effects so that</span>
<span class='co'># the variables (SNPs) explain 50 percent of the variance in the</span>
<span class='co'># outcome.</span>
<span class='no'>u</span>    <span class='kw'>&lt;-</span> <span class='fu'>c</span>(-<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>rnorm</span>(<span class='fl'>20</span>),<span class='fu'>rep</span>(<span class='fl'>0</span>,<span class='fl'>180</span>))
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>/<span class='fu'>sd</span>(<span class='fu'>c</span>(<span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span>)) * <span class='no'>beta</span>

<span class='co'># Generate the quantitative trait measurements.</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(-<span class='fl'>2</span> + <span class='no'>Z</span> <span class='kw'>%*%</span> <span class='no'>u</span> + <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span> + <span class='fu'>rnorm</span>(<span class='fl'>400</span>))

<span class='co'># Fit the variable selection model.</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>varbvs</span>(<span class='no'>X</span>,<span class='no'>Z</span>,<span class='no'>y</span>,<span class='kw'>logodds</span> <span class='kw'>=</span> <span class='fu'>seq</span>(-<span class='fl'>3</span>,-<span class='fl'>1</span>,<span class='fl'>0.1</span>))</div><div class='output co'>#&gt; Welcome to           --       *                              *               
#&gt; VARBVS version 2.0.3 --       |              |               |               
#&gt; large-scale Bayesian --       ||           | |    |          || |     |   |  
#&gt; variable selection   -- |     || | |    |  | ||  ||        |||| ||    |   || 
#&gt; ****************************************************************************
#&gt; Copyright (C) 2012-2017 Peter Carbonetto.
#&gt; See http://www.gnu.org/licenses/gpl.html for the full license.
#&gt; Fitting variational approximation for Bayesian variable selection model.
#&gt; family:     gaussian   num. hyperparameter settings: 21 
#&gt; samples:    400        convergence tolerance         1.0e-04
#&gt; variables:  200        iid variable selection prior: yes 
#&gt; covariates: 3          fit prior var. of coefs (sa): yes 
#&gt; intercept:  yes        fit residual var. (sigma):    yes 
#&gt; Finding best initialization for 21 combinations of hyperparameters.
#&gt; -iteration-   variational    max.   incl variance params
#&gt; outer inner   lower bound  change   vars   sigma      sa
#&gt; 00001 00001 -8.252848e+02 9.5e-03 0000.0 2.0e+00 1.0e-01                                                       00001 00002 -6.850293e+02 9.9e-01 0004.5 1.5e+00 2.0e-01                                                       00001 00003 -6.719952e+02 5.9e-01 0006.2 1.3e+00 1.9e-01                                                       00001 00004 -6.702129e+02 2.5e-01 0006.9 1.3e+00 1.9e-01                                                       00001 00005 -6.700756e+02 3.8e-02 0007.0 1.3e+00 1.9e-01                                                       00001 00006 -6.700631e+02 4.3e-02 0007.1 1.2e+00 1.9e-01                                                       00001 00007 -6.700616e+02 3.8e-03 0007.1 1.2e+00 1.9e-01                                                       00001 00008 -6.700614e+02 5.7e-03 0007.1 1.2e+00 1.9e-01                                                       00001 00009 -6.700614e+02 7.6e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00010 -6.700614e+02 8.0e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00011 -6.700614e+02 1.6e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00012 -6.700614e+02 1.2e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00013 -6.700614e+02 3.5e-05 0007.1 1.2e+00 1.9e-01                                                       00002 00001 -8.253263e+02 1.0e-02 0000.0 2.0e+00 1.0e-01                                                       00002 00002 -6.840365e+02 9.9e-01 0004.7 1.4e+00 1.9e-01                                                       00002 00003 -6.703514e+02 5.6e-01 0006.4 1.3e+00 1.8e-01                                                       00002 00004 -6.686046e+02 2.9e-01 0007.1 1.2e+00 1.9e-01                                                       00002 00005 -6.684687e+02 3.7e-02 0007.2 1.2e+00 1.8e-01                                                       00002 00006 -6.684569e+02 4.4e-02 0007.3 1.2e+00 1.8e-01                                                       00002 00007 -6.684553e+02 3.7e-03 0007.3 1.2e+00 1.8e-01                                                       00002 00008 -6.684552e+02 5.7e-03 0007.3 1.2e+00 1.8e-01                                                       00002 00009 -6.684552e+02 6.2e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00010 -6.684552e+02 7.7e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00011 -6.684552e+02 1.4e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00012 -6.684552e+02 1.1e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00013 -6.684552e+02 3.1e-05 0007.3 1.2e+00 1.8e-01                                                       00003 00001 -8.253786e+02 9.7e-03 0000.1 2.0e+00 1.0e-01                                                       00003 00002 -6.830238e+02 9.9e-01 0005.0 1.4e+00 1.9e-01                                                       00003 00003 -6.686755e+02 5.5e-01 0006.6 1.3e+00 1.8e-01                                                       00003 00004 -6.669639e+02 3.1e-01 0007.3 1.2e+00 1.8e-01                                                       00003 00005 -6.668274e+02 4.0e-02 0007.4 1.2e+00 1.8e-01                                                       00003 00006 -6.668158e+02 4.4e-02 0007.5 1.2e+00 1.8e-01                                                       00003 00007 -6.668142e+02 4.1e-03 0007.5 1.2e+00 1.8e-01                                                       00003 00008 -6.668141e+02 5.6e-03 0007.5 1.2e+00 1.8e-01                                                       00003 00009 -6.668141e+02 4.7e-04 0007.5 1.2e+00 1.8e-01                                                       00003 00010 -6.668140e+02 7.4e-04 0007.5 1.2e+00 1.8e-01                                                       00003 00011 -6.668140e+02 8.5e-05 0007.5 1.2e+00 1.8e-01                                                       00004 00001 -8.254443e+02 9.5e-03 0000.1 2.0e+00 1.0e-01                                                       00004 00002 -6.819484e+02 9.9e-01 0005.2 1.4e+00 1.9e-01                                                       00004 00003 -6.669577e+02 5.3e-01 0006.8 1.3e+00 1.8e-01                                                       00004 00004 -6.652893e+02 3.4e-01 0007.5 1.2e+00 1.8e-01                                                       00004 00005 -6.651511e+02 4.4e-02 0007.7 1.2e+00 1.8e-01                                                       00004 00006 -6.651396e+02 4.3e-02 0007.7 1.2e+00 1.8e-01                                                       00004 00007 -6.651378e+02 4.6e-03 0007.7 1.2e+00 1.8e-01                                                       00004 00008 -6.651377e+02 5.4e-03 0007.8 1.2e+00 1.8e-01                                                       00004 00009 -6.651377e+02 5.6e-04 0007.8 1.2e+00 1.8e-01                                                       00004 00010 -6.651377e+02 7.0e-04 0007.8 1.2e+00 1.8e-01                                                       00004 00011 -6.651377e+02 7.4e-05 0007.8 1.2e+00 1.8e-01                                                       00005 00001 -8.255270e+02 9.9e-03 0000.1 2.0e+00 1.0e-01                                                       00005 00002 -6.808408e+02 9.9e-01 0005.5 1.4e+00 1.9e-01                                                       00005 00003 -6.652059e+02 5.0e-01 0007.1 1.3e+00 1.8e-01                                                       00005 00004 -6.635801e+02 3.5e-01 0007.8 1.2e+00 1.8e-01                                                       00005 00005 -6.634397e+02 4.6e-02 0007.9 1.2e+00 1.8e-01                                                       00005 00006 -6.634280e+02 4.2e-02 0008.0 1.2e+00 1.8e-01                                                       00005 00007 -6.634261e+02 5.0e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00008 -6.634259e+02 5.3e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00009 -6.634259e+02 6.4e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00010 -6.634259e+02 7.1e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00011 -6.634259e+02 9.0e-05 0008.0 1.2e+00 1.8e-01                                                       00006 00001 -8.256313e+02 1.6e-02 0000.1 2.0e+00 1.1e-01                                                       00006 00002 -6.796894e+02 9.8e-01 0005.7 1.4e+00 1.8e-01                                                       00006 00003 -6.634174e+02 4.7e-01 0007.3 1.2e+00 1.8e-01                                                       00006 00004 -6.618367e+02 3.5e-01 0008.0 1.2e+00 1.8e-01                                                       00006 00005 -6.616935e+02 4.8e-02 0008.2 1.2e+00 1.8e-01                                                       00006 00006 -6.616814e+02 4.0e-02 0008.3 1.2e+00 1.8e-01                                                       00006 00007 -6.616793e+02 5.3e-03 0008.3 1.2e+00 1.8e-01                                                       00006 00008 -6.616791e+02 5.1e-03 0008.3 1.2e+00 1.8e-01                                                       00006 00009 -6.616791e+02 6.9e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00010 -6.616791e+02 8.0e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00011 -6.616791e+02 1.0e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00012 -6.616791e+02 1.4e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00013 -6.616791e+02 2.3e-05 0008.3 1.2e+00 1.8e-01                                                       00007 00001 -8.257623e+02 1.9e-02 0000.2 2.0e+00 1.0e-01                                                       00007 00002 -6.786008e+02 9.8e-01 0006.1 1.4e+00 1.8e-01                                                       00007 00003 -6.616227e+02 4.2e-01 0007.6 1.2e+00 1.7e-01                                                       00007 00004 -6.600597e+02 3.4e-01 0008.3 1.2e+00 1.8e-01                                                       00007 00005 -6.599135e+02 4.9e-02 0008.5 1.2e+00 1.8e-01                                                       00007 00006 -6.599007e+02 3.8e-02 0008.6 1.2e+00 1.8e-01                                                       00007 00007 -6.598985e+02 5.9e-03 0008.6 1.2e+00 1.8e-01                                                       00007 00008 -6.598983e+02 4.9e-03 0008.6 1.2e+00 1.8e-01                                                       00007 00009 -6.598983e+02 7.6e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00010 -6.598983e+02 7.0e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00011 -6.598983e+02 9.8e-05 0008.6 1.2e+00 1.8e-01                                                       00008 00001 -8.259274e+02 2.2e-02 0000.2 2.0e+00 1.0e-01                                                       00008 00002 -6.773911e+02 9.8e-01 0006.4 1.4e+00 1.8e-01                                                       00008 00003 -6.597751e+02 4.5e-01 0007.9 1.2e+00 1.7e-01                                                       00008 00004 -6.582514e+02 3.3e-01 0008.6 1.2e+00 1.7e-01                                                       00008 00005 -6.581015e+02 4.8e-02 0008.8 1.2e+00 1.7e-01                                                       00008 00006 -6.580878e+02 3.5e-02 0008.9 1.2e+00 1.7e-01                                                       00008 00007 -6.580854e+02 7.7e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00008 -6.580852e+02 4.6e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00009 -6.580852e+02 1.1e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00010 -6.580852e+02 6.4e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00011 -6.580852e+02 1.7e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00012 -6.580852e+02 9.0e-05 0008.9 1.2e+00 1.7e-01                                                       00009 00001 -8.261349e+02 2.7e-02 0000.2 2.0e+00 1.1e-01                                                       00009 00002 -6.762274e+02 9.7e-01 0006.7 1.3e+00 1.7e-01                                                       00009 00003 -6.579239e+02 4.7e-01 0008.2 1.2e+00 1.7e-01                                                       00009 00004 -6.564161e+02 3.1e-01 0009.0 1.2e+00 1.7e-01                                                       00009 00005 -6.562604e+02 5.2e-02 0009.2 1.2e+00 1.7e-01                                                       00009 00006 -6.562453e+02 3.1e-02 0009.3 1.2e+00 1.7e-01                                                       00009 00007 -6.562428e+02 1.0e-02 0009.3 1.2e+00 1.7e-01                                                       00009 00008 -6.562425e+02 4.3e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00009 -6.562424e+02 1.8e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00010 -6.562424e+02 6.6e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00011 -6.562424e+02 3.4e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00012 -6.562424e+02 1.1e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00013 -6.562424e+02 7.3e-05 0009.3 1.2e+00 1.7e-01                                                       00010 00001 -8.263962e+02 3.7e-02 0000.3 2.0e+00 1.0e-01                                                       00010 00002 -6.750485e+02 9.7e-01 0007.1 1.3e+00 1.7e-01                                                       00010 00003 -6.560581e+02 4.8e-01 0008.5 1.2e+00 1.6e-01                                                       00010 00004 -6.545575e+02 2.8e-01 0009.4 1.2e+00 1.7e-01                                                       00010 00005 -6.543944e+02 6.2e-02 0009.6 1.2e+00 1.7e-01                                                       00010 00006 -6.543775e+02 3.2e-02 0009.7 1.2e+00 1.7e-01                                                       00010 00007 -6.543746e+02 1.3e-02 0009.7 1.2e+00 1.7e-01                                                       00010 00008 -6.543742e+02 5.8e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00009 -6.543741e+02 2.7e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00010 -6.543741e+02 1.1e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00011 -6.543741e+02 6.1e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00012 -6.543741e+02 2.3e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00013 -6.543741e+02 1.5e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00014 -6.543741e+02 5.3e-05 0009.7 1.2e+00 1.7e-01                                                       00011 00001 -8.267244e+02 4.5e-02 0000.4 2.0e+00 1.0e-01                                                       00011 00002 -6.738860e+02 9.7e-01 0007.6 1.3e+00 1.6e-01                                                       00011 00003 -6.541915e+02 4.9e-01 0008.9 1.2e+00 1.6e-01                                                       00011 00004 -6.526839e+02 2.5e-01 0009.8 1.2e+00 1.6e-01                                                       00011 00005 -6.525102e+02 7.2e-02 0010.0 1.2e+00 1.6e-01                                                       00011 00006 -6.524910e+02 4.2e-02 0010.1 1.1e+00 1.6e-01                                                       00011 00007 -6.524874e+02 1.7e-02 0010.2 1.1e+00 1.6e-01                                                       00011 00008 -6.524869e+02 8.1e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00009 -6.524868e+02 3.8e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00010 -6.524868e+02 1.7e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00011 -6.524868e+02 9.0e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00012 -6.524868e+02 3.7e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00013 -6.524868e+02 2.3e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00014 -6.524868e+02 8.9e-05 0010.2 1.1e+00 1.6e-01                                                       00012 00001 -8.271375e+02 5.9e-02 0000.5 2.0e+00 1.0e-01                                                       00012 00002 -6.726989e+02 9.7e-01 0008.1 1.3e+00 1.6e-01                                                       00012 00003 -6.523227e+02 4.9e-01 0009.4 1.2e+00 1.6e-01                                                       00012 00004 -6.508025e+02 2.2e-01 0010.3 1.1e+00 1.6e-01                                                       00012 00005 -6.506173e+02 8.0e-02 0010.5 1.1e+00 1.6e-01                                                       00012 00006 -6.505957e+02 5.0e-02 0010.6 1.1e+00 1.6e-01                                                       00012 00007 -6.505915e+02 1.9e-02 0010.7 1.1e+00 1.6e-01                                                       00012 00008 -6.505909e+02 1.0e-02 0010.7 1.1e+00 1.6e-01                                                       00012 00009 -6.505908e+02 4.5e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00010 -6.505907e+02 2.1e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00011 -6.505907e+02 1.1e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00012 -6.505907e+02 4.8e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00013 -6.505907e+02 2.8e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00014 -6.505907e+02 1.1e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00015 -6.505907e+02 7.2e-05 0010.7 1.1e+00 1.6e-01                                                       00013 00001 -8.276568e+02 7.2e-02 0000.6 2.0e+00 1.0e-01                                                       00013 00002 -6.715466e+02 9.7e-01 0008.7 1.3e+00 1.5e-01                                                       00013 00003 -6.504778e+02 4.9e-01 0009.9 1.2e+00 1.5e-01                                                       00013 00004 -6.489290e+02 2.6e-01 0010.9 1.1e+00 1.6e-01                                                       00013 00005 -6.487309e+02 8.4e-02 0011.1 1.1e+00 1.5e-01                                                       00013 00006 -6.487071e+02 5.6e-02 0011.2 1.1e+00 1.5e-01                                                       00013 00007 -6.487025e+02 2.0e-02 0011.2 1.1e+00 1.5e-01                                                       00013 00008 -6.487017e+02 1.1e-02 0011.3 1.1e+00 1.5e-01                                                       00013 00009 -6.487016e+02 4.6e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00010 -6.487015e+02 2.3e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00011 -6.487015e+02 1.1e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00012 -6.487015e+02 4.9e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00013 -6.487015e+02 2.6e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00014 -6.487015e+02 1.1e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00015 -6.487015e+02 6.5e-05 0011.3 1.1e+00 1.5e-01                                                       00014 00001 -8.283097e+02 9.0e-02 0000.8 1.9e+00 1.0e-01                                                       00014 00002 -6.703283e+02 9.7e-01 0009.3 1.3e+00 1.5e-01                                                       00014 00003 -6.486512e+02 4.9e-01 0010.5 1.2e+00 1.4e-01                                                       00014 00004 -6.470788e+02 2.8e-01 0011.5 1.1e+00 1.5e-01                                                       00014 00005 -6.468718e+02 8.2e-02 0011.7 1.1e+00 1.5e-01                                                       00014 00006 -6.468470e+02 5.6e-02 0011.8 1.1e+00 1.5e-01                                                       00014 00007 -6.468422e+02 1.8e-02 0011.9 1.1e+00 1.5e-01                                                       00014 00008 -6.468414e+02 1.0e-02 0011.9 1.1e+00 1.5e-01                                                       00014 00009 -6.468413e+02 4.0e-03 0011.9 1.1e+00 1.5e-01                                                       00014 00010 -6.468413e+02 2.0e-03 0011.9 1.1e+00 1.5e-01                                                       00014 00011 -6.468412e+02 8.7e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00012 -6.468412e+02 4.1e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00013 -6.468412e+02 1.9e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00014 -6.468412e+02 8.4e-05 0011.9 1.1e+00 1.5e-01                                                       00015 00001 -8.291300e+02 1.1e-01 0000.9 1.9e+00 9.8e-02                                                       00015 00002 -6.692321e+02 9.7e-01 0010.1 1.3e+00 1.4e-01                                                       00015 00003 -6.468948e+02 4.8e-01 0011.2 1.2e+00 1.4e-01                                                       00015 00004 -6.452813e+02 2.9e-01 0012.2 1.1e+00 1.4e-01                                                       00015 00005 -6.450683e+02 7.3e-02 0012.4 1.1e+00 1.4e-01                                                       00015 00006 -6.450437e+02 5.1e-02 0012.5 1.1e+00 1.5e-01                                                       00015 00007 -6.450390e+02 1.5e-02 0012.5 1.1e+00 1.5e-01                                                       00015 00008 -6.450383e+02 8.7e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00009 -6.450382e+02 2.9e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00010 -6.450382e+02 1.5e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00011 -6.450382e+02 5.7e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00012 -6.450382e+02 2.8e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00013 -6.450382e+02 1.1e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00014 -6.450382e+02 5.2e-05 0012.6 1.1e+00 1.5e-01                                                       00016 00001 -8.301582e+02 1.5e-01 0001.2 1.9e+00 9.9e-02                                                       00016 00002 -6.680774e+02 9.6e-01 0011.0 1.3e+00 1.4e-01                                                       00016 00003 -6.452028e+02 4.6e-01 0012.0 1.1e+00 1.3e-01                                                       00016 00004 -6.435668e+02 2.9e-01 0013.1 1.1e+00 1.4e-01                                                       00016 00005 -6.433547e+02 8.7e-02 0013.2 1.1e+00 1.4e-01                                                       00016 00006 -6.433311e+02 4.3e-02 0013.3 1.1e+00 1.4e-01                                                       00016 00007 -6.433268e+02 1.8e-02 0013.3 1.1e+00 1.4e-01                                                       00016 00008 -6.433262e+02 6.7e-03 0013.3 1.1e+00 1.4e-01                                                       00016 00009 -6.433261e+02 2.9e-03 0013.3 1.1e+00 1.4e-01                                                       00016 00010 -6.433261e+02 1.1e-03 0013.3 1.1e+00 1.4e-01                                                       00016 00011 -6.433261e+02 4.5e-04 0013.3 1.1e+00 1.4e-01                                                       00016 00012 -6.433261e+02 1.8e-04 0013.3 1.1e+00 1.4e-01                                                       00016 00013 -6.433261e+02 7.1e-05 0013.3 1.1e+00 1.4e-01                                                       00017 00001 -8.314452e+02 1.6e-01 0001.4 1.9e+00 9.7e-02                                                       00017 00002 -6.670478e+02 9.5e-01 0012.0 1.2e+00 1.3e-01                                                       00017 00003 -6.436475e+02 4.4e-01 0013.0 1.1e+00 1.2e-01                                                       00017 00004 -6.419816e+02 2.6e-01 0014.0 1.1e+00 1.3e-01                                                       00017 00005 -6.417712e+02 1.0e-01 0014.1 1.1e+00 1.3e-01                                                       00017 00006 -6.417485e+02 3.4e-02 0014.2 1.1e+00 1.3e-01                                                       00017 00007 -6.417443e+02 2.0e-02 0014.2 1.1e+00 1.3e-01                                                       00017 00008 -6.417437e+02 4.9e-03 0014.2 1.1e+00 1.3e-01                                                       00017 00009 -6.417436e+02 3.2e-03 0014.2 1.1e+00 1.3e-01                                                       00017 00010 -6.417436e+02 7.4e-04 0014.2 1.1e+00 1.3e-01                                                       00017 00011 -6.417436e+02 5.1e-04 0014.2 1.1e+00 1.3e-01                                                       00017 00012 -6.417436e+02 1.1e-04 0014.2 1.1e+00 1.3e-01                                                       00017 00013 -6.417436e+02 8.1e-05 0014.2 1.1e+00 1.3e-01                                                       00018 00001 -8.330583e+02 2.0e-01 0001.8 1.9e+00 9.7e-02                                                       00018 00002 -6.660657e+02 9.5e-01 0013.1 1.2e+00 1.2e-01                                                       00018 00003 -6.422381e+02 4.2e-01 0014.1 1.1e+00 1.2e-01                                                       00018 00004 -6.405654e+02 2.3e-01 0015.1 1.1e+00 1.2e-01                                                       00018 00005 -6.403609e+02 1.1e-01 0015.1 1.1e+00 1.3e-01                                                       00018 00006 -6.403389e+02 2.6e-02 0015.2 1.1e+00 1.3e-01                                                       00018 00007 -6.403347e+02 2.1e-02 0015.2 1.1e+00 1.3e-01                                                       00018 00008 -6.403342e+02 3.5e-03 0015.2 1.1e+00 1.3e-01                                                       00018 00009 -6.403341e+02 3.5e-03 0015.2 1.1e+00 1.3e-01                                                       00018 00010 -6.403341e+02 5.1e-04 0015.2 1.1e+00 1.3e-01                                                       00018 00011 -6.403341e+02 5.6e-04 0015.2 1.1e+00 1.3e-01                                                       00018 00012 -6.403341e+02 8.4e-05 0015.2 1.1e+00 1.3e-01                                                       00019 00001 -8.350789e+02 2.3e-01 0002.2 1.9e+00 9.4e-02                                                       00019 00002 -6.651113e+02 9.3e-01 0014.5 1.2e+00 1.1e-01                                                       00019 00003 -6.410140e+02 4.3e-01 0015.4 1.1e+00 1.1e-01                                                       00019 00004 -6.393673e+02 1.9e-01 0016.5 1.1e+00 1.2e-01                                                       00019 00005 -6.391714e+02 1.2e-01 0016.4 1.1e+00 1.2e-01                                                       00019 00006 -6.391499e+02 1.9e-02 0016.5 1.1e+00 1.2e-01                                                       00019 00007 -6.391457e+02 2.1e-02 0016.5 1.1e+00 1.2e-01                                                       00019 00008 -6.391451e+02 3.5e-03 0016.5 1.1e+00 1.2e-01                                                       00019 00009 -6.391450e+02 3.6e-03 0016.5 1.1e+00 1.2e-01                                                       00019 00010 -6.391450e+02 6.4e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00011 -6.391450e+02 6.1e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00012 -6.391450e+02 1.1e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00013 -6.391450e+02 1.0e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00014 -6.391450e+02 1.8e-05 0016.5 1.1e+00 1.2e-01                                                       00020 00001 -8.375898e+02 2.7e-01 0002.7 1.9e+00 9.2e-02                                                       00020 00002 -6.644353e+02 9.2e-01 0016.1 1.2e+00 1.0e-01                                                       00020 00003 -6.400734e+02 4.3e-01 0017.0 1.1e+00 1.0e-01                                                       00020 00004 -6.384460e+02 1.6e-01 0018.1 1.1e+00 1.1e-01                                                       00020 00005 -6.382550e+02 1.2e-01 0018.0 1.1e+00 1.1e-01                                                       00020 00006 -6.382331e+02 1.9e-02 0018.1 1.1e+00 1.1e-01                                                       00020 00007 -6.382284e+02 2.1e-02 0018.0 1.1e+00 1.1e-01                                                       00020 00008 -6.382277e+02 4.2e-03 0018.0 1.1e+00 1.1e-01                                                       00020 00009 -6.382276e+02 3.7e-03 0018.0 1.1e+00 1.1e-01                                                       00020 00010 -6.382276e+02 8.2e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00011 -6.382275e+02 6.6e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00012 -6.382275e+02 1.5e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00013 -6.382275e+02 1.2e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00014 -6.382275e+02 2.7e-05 0018.0 1.1e+00 1.1e-01                                                       00021 00001 -8.407119e+02 3.5e-01 0003.3 1.8e+00 9.0e-02                                                       00021 00002 -6.638506e+02 9.2e-01 0018.0 1.2e+00 9.6e-02                                                       00021 00003 -6.394259e+02 4.2e-01 0019.0 1.1e+00 9.1e-02                                                       00021 00004 -6.378466e+02 1.3e-01 0020.2 1.1e+00 9.8e-02                                                       00021 00005 -6.376635e+02 1.1e-01 0020.0 1.1e+00 9.9e-02                                                       00021 00006 -6.376414e+02 2.0e-02 0020.0 1.1e+00 1.0e-01                                                       00021 00007 -6.376361e+02 2.0e-02 0020.0 1.1e+00 1.0e-01                                                       00021 00008 -6.376353e+02 4.7e-03 0020.0 1.1e+00 1.0e-01                                                       00021 00009 -6.376351e+02 3.7e-03 0020.0 1.1e+00 1.0e-01                                                       00021 00010 -6.376351e+02 1.0e-03 0020.0 1.1e+00 1.0e-01                                                       00021 00011 -6.376351e+02 7.0e-04 0020.0 1.1e+00 1.0e-01                                                       00021 00012 -6.376351e+02 2.0e-04 0020.0 1.1e+00 1.0e-01                                                       00021 00013 -6.376351e+02 1.3e-04 0020.0 1.1e+00 1.0e-01                                                       00021 00014 -6.376351e+02 4.0e-05 0020.0 1.1e+00 1.0e-01                                                       
#&gt; Computing marginal likelihood for 21 combinations of hyperparameters.
#&gt; -iteration-   variational    max.   incl variance params
#&gt; outer inner   lower bound  change   vars   sigma      sa
#&gt; 00001 00001 -6.736612e+02 8.0e-01 0008.2 1.2e+00 1.7e-01                                                       00001 00002 -6.701884e+02 4.3e-01 0007.3 1.2e+00 1.8e-01                                                       00001 00003 -6.700690e+02 5.1e-02 0007.2 1.2e+00 1.9e-01                                                       00001 00004 -6.700623e+02 3.9e-02 0007.1 1.2e+00 1.9e-01                                                       00001 00005 -6.700616e+02 4.3e-03 0007.1 1.2e+00 1.9e-01                                                       00001 00006 -6.700614e+02 4.7e-03 0007.1 1.2e+00 1.9e-01                                                       00001 00007 -6.700614e+02 1.1e-03 0007.1 1.2e+00 1.9e-01                                                       00001 00008 -6.700614e+02 6.9e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00009 -6.700614e+02 2.5e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00010 -6.700614e+02 1.3e-04 0007.1 1.2e+00 1.9e-01                                                       00001 00011 -6.700614e+02 5.4e-05 0007.1 1.2e+00 1.9e-01                                                       00002 00001 -6.718212e+02 7.6e-01 0008.4 1.2e+00 1.6e-01                                                       00002 00002 -6.685760e+02 3.8e-01 0007.5 1.2e+00 1.8e-01                                                       00002 00003 -6.684627e+02 5.3e-02 0007.4 1.2e+00 1.8e-01                                                       00002 00004 -6.684560e+02 3.8e-02 0007.3 1.2e+00 1.8e-01                                                       00002 00005 -6.684553e+02 4.6e-03 0007.3 1.2e+00 1.8e-01                                                       00002 00006 -6.684552e+02 4.6e-03 0007.3 1.2e+00 1.8e-01                                                       00002 00007 -6.684552e+02 1.3e-03 0007.3 1.2e+00 1.8e-01                                                       00002 00008 -6.684552e+02 6.9e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00009 -6.684552e+02 3.1e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00010 -6.684552e+02 1.6e-04 0007.3 1.2e+00 1.8e-01                                                       00002 00011 -6.684552e+02 7.2e-05 0007.3 1.2e+00 1.8e-01                                                       00003 00001 -6.699463e+02 7.3e-01 0008.6 1.2e+00 1.6e-01                                                       00003 00002 -6.669297e+02 3.3e-01 0007.7 1.2e+00 1.8e-01                                                       00003 00003 -6.668219e+02 5.7e-02 0007.6 1.2e+00 1.8e-01                                                       00003 00004 -6.668149e+02 3.8e-02 0007.5 1.2e+00 1.8e-01                                                       00003 00005 -6.668142e+02 5.2e-03 0007.5 1.2e+00 1.8e-01                                                       00003 00006 -6.668141e+02 4.7e-03 0007.5 1.2e+00 1.8e-01                                                       00003 00007 -6.668141e+02 1.5e-03 0007.5 1.2e+00 1.8e-01                                                       00003 00008 -6.668140e+02 8.4e-04 0007.5 1.2e+00 1.8e-01                                                       00003 00009 -6.668140e+02 4.0e-04 0007.5 1.2e+00 1.8e-01                                                       00003 00010 -6.668140e+02 2.0e-04 0007.5 1.2e+00 1.8e-01                                                       00003 00011 -6.668140e+02 9.9e-05 0007.5 1.2e+00 1.8e-01                                                       00004 00001 -6.680356e+02 7.0e-01 0008.9 1.2e+00 1.6e-01                                                       00004 00002 -6.652489e+02 2.7e-01 0008.0 1.2e+00 1.8e-01                                                       00004 00003 -6.651462e+02 6.5e-02 0007.8 1.2e+00 1.8e-01                                                       00004 00004 -6.651386e+02 3.7e-02 0007.8 1.2e+00 1.8e-01                                                       00004 00005 -6.651378e+02 6.0e-03 0007.8 1.2e+00 1.8e-01                                                       00004 00006 -6.651377e+02 4.8e-03 0007.8 1.2e+00 1.8e-01                                                       00004 00007 -6.651377e+02 1.8e-03 0007.8 1.2e+00 1.8e-01                                                       00004 00008 -6.651377e+02 1.0e-03 0007.8 1.2e+00 1.8e-01                                                       00004 00009 -6.651377e+02 5.1e-04 0007.8 1.2e+00 1.8e-01                                                       00004 00010 -6.651377e+02 2.7e-04 0007.8 1.2e+00 1.8e-01                                                       00004 00011 -6.651377e+02 1.4e-04 0007.8 1.2e+00 1.8e-01                                                       00004 00012 -6.651377e+02 7.1e-05 0007.8 1.2e+00 1.8e-01                                                       00005 00001 -6.660892e+02 6.6e-01 0009.1 1.2e+00 1.6e-01                                                       00005 00002 -6.635328e+02 2.5e-01 0008.3 1.2e+00 1.8e-01                                                       00005 00003 -6.634353e+02 7.4e-02 0008.1 1.2e+00 1.8e-01                                                       00005 00004 -6.634271e+02 3.5e-02 0008.0 1.2e+00 1.8e-01                                                       00005 00005 -6.634261e+02 8.0e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00006 -6.634259e+02 5.0e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00007 -6.634259e+02 2.2e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00008 -6.634259e+02 1.2e-03 0008.0 1.2e+00 1.8e-01                                                       00005 00009 -6.634259e+02 6.2e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00010 -6.634259e+02 3.6e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00011 -6.634259e+02 1.7e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00012 -6.634259e+02 1.0e-04 0008.0 1.2e+00 1.8e-01                                                       00005 00013 -6.634259e+02 4.8e-05 0008.0 1.2e+00 1.8e-01                                                       00006 00001 -6.641075e+02 6.2e-01 0009.4 1.2e+00 1.6e-01                                                       00006 00002 -6.617813e+02 2.7e-01 0008.6 1.2e+00 1.7e-01                                                       00006 00003 -6.616896e+02 8.2e-02 0008.4 1.2e+00 1.8e-01                                                       00006 00004 -6.616806e+02 3.2e-02 0008.3 1.2e+00 1.8e-01                                                       00006 00005 -6.616795e+02 1.1e-02 0008.3 1.2e+00 1.8e-01                                                       00006 00006 -6.616792e+02 5.2e-03 0008.3 1.2e+00 1.8e-01                                                       00006 00007 -6.616791e+02 2.4e-03 0008.3 1.2e+00 1.8e-01                                                       00006 00008 -6.616791e+02 1.6e-03 0008.3 1.2e+00 1.8e-01                                                       00006 00009 -6.616791e+02 7.1e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00010 -6.616791e+02 4.8e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00011 -6.616791e+02 2.0e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00012 -6.616791e+02 1.4e-04 0008.3 1.2e+00 1.8e-01                                                       00006 00013 -6.616791e+02 5.8e-05 0008.3 1.2e+00 1.8e-01                                                       00007 00001 -6.620921e+02 5.7e-01 0009.7 1.2e+00 1.6e-01                                                       00007 00002 -6.599946e+02 2.9e-01 0008.9 1.2e+00 1.7e-01                                                       00007 00003 -6.599096e+02 8.9e-02 0008.7 1.2e+00 1.7e-01                                                       00007 00004 -6.599001e+02 2.8e-02 0008.6 1.2e+00 1.7e-01                                                       00007 00005 -6.598988e+02 1.3e-02 0008.6 1.2e+00 1.7e-01                                                       00007 00006 -6.598984e+02 6.0e-03 0008.6 1.2e+00 1.8e-01                                                       00007 00007 -6.598983e+02 2.8e-03 0008.6 1.2e+00 1.8e-01                                                       00007 00008 -6.598983e+02 1.9e-03 0008.6 1.2e+00 1.8e-01                                                       00007 00009 -6.598983e+02 7.3e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00010 -6.598983e+02 5.8e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00011 -6.598983e+02 2.1e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00012 -6.598983e+02 1.7e-04 0008.6 1.2e+00 1.8e-01                                                       00007 00013 -6.598983e+02 6.2e-05 0008.6 1.2e+00 1.8e-01                                                       00008 00001 -6.600464e+02 5.5e-01 0010.0 1.2e+00 1.6e-01                                                       00008 00002 -6.581735e+02 3.0e-01 0009.2 1.2e+00 1.7e-01                                                       00008 00003 -6.580968e+02 9.4e-02 0009.0 1.2e+00 1.7e-01                                                       00008 00004 -6.580873e+02 2.5e-02 0009.0 1.2e+00 1.7e-01                                                       00008 00005 -6.580857e+02 1.6e-02 0008.9 1.2e+00 1.7e-01                                                       00008 00006 -6.580853e+02 6.4e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00007 -6.580852e+02 3.6e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00008 -6.580852e+02 2.0e-03 0008.9 1.2e+00 1.7e-01                                                       00008 00009 -6.580852e+02 9.3e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00010 -6.580852e+02 6.2e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00011 -6.580852e+02 2.6e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00012 -6.580852e+02 1.9e-04 0008.9 1.2e+00 1.7e-01                                                       00008 00013 -6.580852e+02 7.2e-05 0008.9 1.2e+00 1.7e-01                                                       00009 00001 -6.579756e+02 5.4e-01 0010.3 1.1e+00 1.5e-01                                                       00009 00002 -6.563201e+02 2.9e-01 0009.6 1.2e+00 1.7e-01                                                       00009 00003 -6.562534e+02 9.4e-02 0009.4 1.2e+00 1.7e-01                                                       00009 00004 -6.562446e+02 3.0e-02 0009.4 1.2e+00 1.7e-01                                                       00009 00005 -6.562430e+02 1.8e-02 0009.3 1.2e+00 1.7e-01                                                       00009 00006 -6.562425e+02 6.2e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00007 -6.562424e+02 4.3e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00008 -6.562424e+02 2.0e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00009 -6.562424e+02 1.1e-03 0009.3 1.2e+00 1.7e-01                                                       00009 00010 -6.562424e+02 6.0e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00011 -6.562424e+02 3.1e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00012 -6.562424e+02 1.8e-04 0009.3 1.2e+00 1.7e-01                                                       00009 00013 -6.562424e+02 8.9e-05 0009.3 1.2e+00 1.7e-01                                                       00010 00001 -6.558873e+02 5.2e-01 0010.7 1.1e+00 1.5e-01                                                       00010 00002 -6.544391e+02 2.7e-01 0010.0 1.1e+00 1.6e-01                                                       00010 00003 -6.543836e+02 8.9e-02 0009.8 1.2e+00 1.7e-01                                                       00010 00004 -6.543762e+02 3.3e-02 0009.8 1.2e+00 1.7e-01                                                       00010 00005 -6.543747e+02 1.9e-02 0009.8 1.2e+00 1.7e-01                                                       00010 00006 -6.543743e+02 6.7e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00007 -6.543742e+02 4.7e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00008 -6.543741e+02 1.7e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00009 -6.543741e+02 1.3e-03 0009.7 1.2e+00 1.7e-01                                                       00010 00010 -6.543741e+02 5.2e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00011 -6.543741e+02 3.5e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00012 -6.543741e+02 1.5e-04 0009.7 1.2e+00 1.7e-01                                                       00010 00013 -6.543741e+02 9.7e-05 0009.7 1.2e+00 1.7e-01                                                       00011 00001 -6.537919e+02 5.0e-01 0011.1 1.1e+00 1.5e-01                                                       00011 00002 -6.525383e+02 2.4e-01 0010.4 1.1e+00 1.6e-01                                                       00011 00003 -6.524940e+02 7.9e-02 0010.3 1.1e+00 1.6e-01                                                       00011 00004 -6.524885e+02 3.2e-02 0010.2 1.1e+00 1.6e-01                                                       00011 00005 -6.524873e+02 1.8e-02 0010.2 1.1e+00 1.6e-01                                                       00011 00006 -6.524869e+02 6.8e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00007 -6.524868e+02 4.5e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00008 -6.524868e+02 1.7e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00009 -6.524868e+02 1.2e-03 0010.2 1.1e+00 1.6e-01                                                       00011 00010 -6.524868e+02 4.4e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00011 -6.524868e+02 3.3e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00012 -6.524868e+02 1.2e-04 0010.2 1.1e+00 1.6e-01                                                       00011 00013 -6.524868e+02 9.0e-05 0010.2 1.1e+00 1.6e-01                                                       00012 00001 -6.517031e+02 4.7e-01 0011.5 1.1e+00 1.5e-01                                                       00012 00002 -6.506300e+02 2.0e-01 0010.9 1.1e+00 1.6e-01                                                       00012 00003 -6.505955e+02 6.5e-02 0010.8 1.1e+00 1.6e-01                                                       00012 00004 -6.505919e+02 2.7e-02 0010.8 1.1e+00 1.6e-01                                                       00012 00005 -6.505910e+02 1.4e-02 0010.7 1.1e+00 1.6e-01                                                       00012 00006 -6.505908e+02 5.9e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00007 -6.505907e+02 3.7e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00008 -6.505907e+02 1.4e-03 0010.7 1.1e+00 1.6e-01                                                       00012 00009 -6.505907e+02 9.6e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00010 -6.505907e+02 3.7e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00011 -6.505907e+02 2.6e-04 0010.7 1.1e+00 1.6e-01                                                       00012 00012 -6.505907e+02 9.7e-05 0010.7 1.1e+00 1.6e-01                                                       00013 00001 -6.496376e+02 4.4e-01 0012.0 1.1e+00 1.4e-01                                                       00013 00002 -6.487313e+02 1.6e-01 0011.4 1.1e+00 1.5e-01                                                       00013 00003 -6.487043e+02 4.9e-02 0011.3 1.1e+00 1.5e-01                                                       00013 00004 -6.487022e+02 2.0e-02 0011.3 1.1e+00 1.5e-01                                                       00013 00005 -6.487017e+02 1.0e-02 0011.3 1.1e+00 1.5e-01                                                       00013 00006 -6.487016e+02 4.2e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00007 -6.487015e+02 2.5e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00008 -6.487015e+02 1.0e-03 0011.3 1.1e+00 1.5e-01                                                       00013 00009 -6.487015e+02 6.3e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00010 -6.487015e+02 2.4e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00011 -6.487015e+02 1.6e-04 0011.3 1.1e+00 1.5e-01                                                       00013 00012 -6.487015e+02 6.0e-05 0011.3 1.1e+00 1.5e-01                                                       00014 00001 -6.476163e+02 4.0e-01 0012.5 1.1e+00 1.4e-01                                                       00014 00002 -6.468648e+02 1.2e-01 0012.0 1.1e+00 1.5e-01                                                       00014 00003 -6.468428e+02 3.5e-02 0011.9 1.1e+00 1.5e-01                                                       00014 00004 -6.468415e+02 1.3e-02 0011.9 1.1e+00 1.5e-01                                                       00014 00005 -6.468413e+02 6.6e-03 0011.9 1.1e+00 1.5e-01                                                       00014 00006 -6.468413e+02 2.5e-03 0011.9 1.1e+00 1.5e-01                                                       00014 00007 -6.468413e+02 1.5e-03 0011.9 1.1e+00 1.5e-01                                                       00014 00008 -6.468412e+02 5.5e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00009 -6.468412e+02 3.4e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00010 -6.468412e+02 1.2e-04 0011.9 1.1e+00 1.5e-01                                                       00014 00011 -6.468412e+02 7.8e-05 0011.9 1.1e+00 1.5e-01                                                       00015 00001 -6.456642e+02 3.5e-01 0013.1 1.1e+00 1.4e-01                                                       00015 00002 -6.450580e+02 8.9e-02 0012.7 1.1e+00 1.4e-01                                                       00015 00003 -6.450392e+02 2.3e-02 0012.6 1.1e+00 1.5e-01                                                       00015 00004 -6.450383e+02 7.4e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00005 -6.450382e+02 3.7e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00006 -6.450382e+02 1.2e-03 0012.6 1.1e+00 1.5e-01                                                       00015 00007 -6.450382e+02 7.3e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00008 -6.450382e+02 2.4e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00009 -6.450382e+02 1.5e-04 0012.6 1.1e+00 1.5e-01                                                       00015 00010 -6.450382e+02 4.9e-05 0012.6 1.1e+00 1.5e-01                                                       00016 00001 -6.438119e+02 3.0e-01 0013.9 1.1e+00 1.3e-01                                                       00016 00002 -6.433434e+02 6.1e-02 0013.4 1.1e+00 1.4e-01                                                       00016 00003 -6.433269e+02 1.4e-02 0013.3 1.1e+00 1.4e-01                                                       00016 00004 -6.433261e+02 3.5e-03 0013.3 1.1e+00 1.4e-01                                                       00016 00005 -6.433261e+02 1.9e-03 0013.3 1.1e+00 1.4e-01                                                       00016 00006 -6.433261e+02 5.7e-04 0013.3 1.1e+00 1.4e-01                                                       00016 00007 -6.433261e+02 3.1e-04 0013.3 1.1e+00 1.4e-01                                                       00016 00008 -6.433261e+02 9.8e-05 0013.3 1.1e+00 1.4e-01                                                       00017 00001 -6.420964e+02 2.5e-01 0014.7 1.1e+00 1.3e-01                                                       00017 00002 -6.417584e+02 3.9e-02 0014.3 1.1e+00 1.3e-01                                                       00017 00003 -6.417444e+02 1.0e-02 0014.2 1.1e+00 1.3e-01                                                       00017 00004 -6.417437e+02 2.4e-03 0014.2 1.1e+00 1.3e-01                                                       00017 00005 -6.417436e+02 1.1e-03 0014.2 1.1e+00 1.3e-01                                                       00017 00006 -6.417436e+02 4.2e-04 0014.2 1.1e+00 1.3e-01                                                       00017 00007 -6.417436e+02 2.5e-04 0014.2 1.1e+00 1.3e-01                                                       00017 00008 -6.417436e+02 6.8e-05 0014.2 1.1e+00 1.3e-01                                                       00018 00001 -6.405622e+02 1.9e-01 0015.7 1.1e+00 1.2e-01                                                       00018 00002 -6.403456e+02 2.3e-02 0015.3 1.1e+00 1.3e-01                                                       00018 00003 -6.403348e+02 1.0e-02 0015.2 1.1e+00 1.3e-01                                                       00018 00004 -6.403341e+02 1.8e-03 0015.2 1.1e+00 1.3e-01                                                       00018 00005 -6.403341e+02 1.4e-03 0015.2 1.1e+00 1.3e-01                                                       00018 00006 -6.403341e+02 3.1e-04 0015.2 1.1e+00 1.3e-01                                                       00018 00007 -6.403341e+02 3.0e-04 0015.2 1.1e+00 1.3e-01                                                       00018 00008 -6.403341e+02 5.1e-05 0015.2 1.1e+00 1.3e-01                                                       00019 00001 -6.392628e+02 1.2e-01 0016.9 1.1e+00 1.1e-01                                                       00019 00002 -6.391521e+02 1.8e-02 0016.6 1.1e+00 1.2e-01                                                       00019 00003 -6.391455e+02 9.2e-03 0016.5 1.1e+00 1.2e-01                                                       00019 00004 -6.391450e+02 1.3e-03 0016.5 1.1e+00 1.2e-01                                                       00019 00005 -6.391450e+02 1.4e-03 0016.5 1.1e+00 1.2e-01                                                       00019 00006 -6.391450e+02 3.4e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00007 -6.391450e+02 2.9e-04 0016.5 1.1e+00 1.2e-01                                                       00019 00008 -6.391450e+02 6.1e-05 0016.5 1.1e+00 1.2e-01                                                       00020 00001 -6.382621e+02 6.2e-02 0018.3 1.1e+00 1.1e-01                                                       00020 00002 -6.382301e+02 1.1e-02 0018.1 1.1e+00 1.1e-01                                                       00020 00003 -6.382278e+02 6.1e-03 0018.0 1.1e+00 1.1e-01                                                       00020 00004 -6.382276e+02 9.5e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00005 -6.382276e+02 9.0e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00006 -6.382275e+02 2.7e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00007 -6.382275e+02 2.0e-04 0018.0 1.1e+00 1.1e-01                                                       00020 00008 -6.382275e+02 5.4e-05 0018.0 1.1e+00 1.1e-01                                                       00021 00001 -6.376351e+02 2.5e-05 0020.0 1.1e+00 1.0e-01                                                       
#&gt; Estimating proportion of variance in Y explained by model.</div><div class='input'><span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='no'>fit</span>))</div><div class='output co'>#&gt; Summary of fitted Bayesian variable selection model:
#&gt; family:     gaussian   num. hyperparameter settings: 21
#&gt; samples:    400        iid variable selection prior: yes
#&gt; variables:  200        fit prior var. of coefs (sa): yes
#&gt; covariates: 4          fit residual var. (sigma):    yes
#&gt; maximum log-likelihood lower bound: -649.6435
#&gt; proportion of variance explained: 0.459 [0.400,0.509]
#&gt; Hyperparameters: 
#&gt;         estimate Pr&gt;0.95             candidate values
#&gt; sigma       1.06 [1.06,1.07]         NA--NA
#&gt; sa         0.108 [0.102,0.119]       NA--NA
#&gt; logodds    -1.07 [-1.20,-1.00]       (-3.00)--(-1.00)
#&gt; Selected variables by probability cutoff:
#&gt; &gt;0.10 &gt;0.25 &gt;0.50 &gt;0.75 &gt;0.90 &gt;0.95 
#&gt;    22    14    12    11    11     9 
#&gt; Top 5 variables by inclusion probability:
#&gt;   index variable prob    PVE   coef  Pr(coef.&gt;0.95)
#&gt; 1    17      X17    1 0.0664  0.520 [+0.376,+0.657]
#&gt; 2     7       X7    1 0.0540 -0.453 [-0.594,-0.312]
#&gt; 3     6       X6    1 0.0483  0.438 [+0.294,+0.591]
#&gt; 4     8       X8    1 0.0461  0.431 [+0.287,+0.574]
#&gt; 5    18      X18    1 0.0396  0.447 [+0.292,+0.604]</div><div class='input'>
<span class='co'># Compute posterior inclusion probabilities (pip) and posterior mean</span>
<span class='co'># regression coefficients (beta) averaged over the hyperparameter</span>
<span class='co'># settings.</span>
<span class='no'>w</span>    <span class='kw'>&lt;-</span> <span class='fu'><a href='normalizelogweights.html'>normalizelogweights</a></span>(<span class='no'>fit</span>$<span class='no'>logw</span>);
<span class='no'>pip</span>  <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='no'>alpha</span> <span class='kw'>%*%</span> <span class='fu'>c</span>(<span class='no'>w</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='no'>mu</span> <span class='kw'>%*%</span> <span class='fu'>c</span>(<span class='no'>w</span>)

<span class='co'># Compute the posterior mean estimate of hyperparameter sa.</span>
<span class='no'>sa</span> <span class='kw'>&lt;-</span> <span class='fu'>sum</span>(<span class='no'>fit</span>$<span class='no'>sa</span> * <span class='no'>w</span>)

<span class='co'># Compare estimated outcomes against observed outcomes.</span>
<span class='no'>y.fit</span> <span class='kw'>&lt;-</span> <span class='fu'>predict</span>(<span class='no'>fit</span>,<span class='no'>X</span>,<span class='no'>Z</span>)
<span class='fu'>print</span>(<span class='fu'>cor</span>(<span class='no'>y</span>,<span class='no'>y.fit</span>))</div><div class='output co'>#&gt; [1] 0.933</div><div class='input'>
<span class='co'># LOGISTIC REGRESSION EXAMPLE</span>
<span class='co'># ---------------------------</span>
<span class='co'># Data are 100 uncorrelated ("unlinked") single nucleotide polymorphisms</span>
<span class='co'># (SNPs) with simulated genotypes, in which the first 10 of them have an</span>
<span class='co'># effect on the outcome. Also generate data for 2 covariates.</span>
<span class='no'>maf</span> <span class='kw'>&lt;-</span> <span class='fl'>0.05</span> + <span class='fl'>0.45</span>*<span class='fu'>runif</span>(<span class='fl'>100</span>)
<span class='no'>X</span>   <span class='kw'>&lt;-</span> (<span class='fu'>runif</span>(<span class='fl'>750</span>*<span class='fl'>100</span>) <span class='kw'>&lt;</span> <span class='no'>maf</span>) + (<span class='fu'>runif</span>(<span class='fl'>750</span>*<span class='fl'>100</span>) <span class='kw'>&lt;</span> <span class='no'>maf</span>)
<span class='no'>X</span>   <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>as.double</span>(<span class='no'>X</span>),<span class='fl'>750</span>,<span class='fl'>100</span>,<span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>Z</span>   <span class='kw'>&lt;-</span> <span class='fu'><a href='rand.html'>randn</a></span>(<span class='fl'>750</span>,<span class='fl'>2</span>)

<span class='co'># Generate the ground-truth regression coefficients for the variables</span>
<span class='co'># (X) and additional 2 covariates (Z).</span>
<span class='no'>u</span>    <span class='kw'>&lt;-</span> <span class='fu'>c</span>(-<span class='fl'>1</span>,<span class='fl'>1</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0.5</span>*<span class='fu'>rnorm</span>(<span class='fl'>10</span>),<span class='fu'>rep</span>(<span class='fl'>0</span>,<span class='fl'>90</span>))

<span class='co'># Simulate the binary trait (case-control status) as a coin toss with</span>
<span class='co'># success rates given by the logistic regression.</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>as.double</span>(<span class='fu'>runif</span>(<span class='fl'>750</span>) <span class='kw'>&lt;</span> <span class='fu'><a href='varbvs-internal.html'>sigmoid</a></span>(-<span class='fl'>1</span> + <span class='no'>Z</span> <span class='kw'>%*%</span> <span class='no'>u</span> + <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span>))

<span class='co'># Fit the variable selection model.</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>varbvs</span>(<span class='no'>X</span>,<span class='no'>Z</span>,<span class='no'>y</span>,<span class='st'>"binomial"</span>,<span class='kw'>logodds</span> <span class='kw'>=</span> <span class='fu'>seq</span>(-<span class='fl'>2</span>,-<span class='fl'>0.5</span>,<span class='fl'>0.5</span>))</div><div class='output co'>#&gt; Welcome to           --       *                              *               
#&gt; VARBVS version 2.0.3 --       |              |               |               
#&gt; large-scale Bayesian --       ||           | |    |          || |     |   |  
#&gt; variable selection   -- |     || | |    |  | ||  ||        |||| ||    |   || 
#&gt; ****************************************************************************
#&gt; Copyright (C) 2012-2017 Peter Carbonetto.
#&gt; See http://www.gnu.org/licenses/gpl.html for the full license.
#&gt; Fitting variational approximation for Bayesian variable selection model.
#&gt; family:     binomial   num. hyperparameter settings: 4 
#&gt; samples:    750        convergence tolerance         1.0e-04
#&gt; variables:  100        iid variable selection prior: yes 
#&gt; covariates: 2          fit prior var. of coefs (sa): yes 
#&gt; intercept:  yes        fit approx. factors (eta):    yes 
#&gt; Finding best initialization for 4 combinations of hyperparameters.
#&gt; -iteration-   variational    max.   incl variance params
#&gt; outer inner   lower bound  change   vars   sigma      sa
#&gt; 00001 00001 -3.857136e+02 1.0e+00 0002.5      NA 5.9e-01                                                       00001 00002 -3.795824e+02 5.2e-01 0003.2      NA 7.3e-01                                                       00001 00003 -3.769478e+02 2.7e-01 0003.4      NA 8.6e-01                                                       00001 00004 -3.759048e+02 6.5e-02 0003.5      NA 9.7e-01                                                       00001 00005 -3.755373e+02 4.0e-02 0003.5      NA 1.0e+00                                                       00001 00006 -3.754024e+02 1.4e-02 0003.6      NA 1.1e+00                                                       00001 00007 -3.753505e+02 2.3e-02 0003.6      NA 1.1e+00                                                       00001 00008 -3.753299e+02 1.2e-02 0003.6      NA 1.1e+00                                                       00001 00009 -3.753215e+02 1.4e-02 0003.6      NA 1.1e+00                                                       00001 00010 -3.753179e+02 8.3e-03 0003.6      NA 1.2e+00                                                       00001 00011 -3.753163e+02 8.3e-03 0003.6      NA 1.2e+00                                                       00001 00012 -3.753156e+02 5.3e-03 0003.6      NA 1.2e+00                                                       00001 00013 -3.753153e+02 4.8e-03 0003.6      NA 1.2e+00                                                       00001 00014 -3.753151e+02 3.2e-03 0003.6      NA 1.2e+00                                                       00001 00015 -3.753151e+02 2.7e-03 0003.6      NA 1.2e+00                                                       00001 00016 -3.753150e+02 1.9e-03 0003.6      NA 1.2e+00                                                       00001 00017 -3.753150e+02 1.5e-03 0003.6      NA 1.2e+00                                                       00001 00018 -3.753150e+02 1.0e-03 0003.6      NA 1.2e+00                                                       00001 00019 -3.753150e+02 8.4e-04 0003.6      NA 1.2e+00                                                       00001 00020 -3.753150e+02 5.8e-04 0003.6      NA 1.2e+00                                                       00001 00021 -3.753150e+02 4.6e-04 0003.6      NA 1.2e+00                                                       00001 00022 -3.753150e+02 3.2e-04 0003.6      NA 1.2e+00                                                       00001 00023 -3.753150e+02 2.5e-04 0003.6      NA 1.2e+00                                                       00001 00024 -3.753150e+02 1.7e-04 0003.6      NA 1.2e+00                                                       00001 00025 -3.753150e+02 1.3e-04 0003.6      NA 1.2e+00                                                       00001 00026 -3.753150e+02 9.2e-05 0003.6      NA 1.2e+00                                                       00002 00001 -3.837979e+02 9.9e-01 0003.5      NA 4.5e-01                                                       00002 00002 -3.766348e+02 5.3e-01 0004.7      NA 5.3e-01                                                       00002 00003 -3.741232e+02 2.2e-01 0004.9      NA 6.4e-01                                                       00002 00004 -3.730746e+02 1.3e-01 0005.0      NA 7.3e-01                                                       00002 00005 -3.725626e+02 1.7e-01 0005.2      NA 7.7e-01                                                       00002 00006 -3.722718e+02 1.1e-01 0005.3      NA 8.1e-01                                                       00002 00007 -3.721154e+02 7.2e-02 0005.4      NA 8.3e-01                                                       00002 00008 -3.720416e+02 2.9e-02 0005.4      NA 8.5e-01                                                       00002 00009 -3.720093e+02 1.5e-02 0005.5      NA 8.6e-01                                                       00002 00010 -3.719949e+02 1.6e-02 0005.5      NA 8.7e-01                                                       00002 00011 -3.719883e+02 1.1e-02 0005.5      NA 8.8e-01                                                       00002 00012 -3.719852e+02 1.0e-02 0005.5      NA 8.8e-01                                                       00002 00013 -3.719837e+02 7.0e-03 0005.5      NA 8.8e-01                                                       00002 00014 -3.719830e+02 6.3e-03 0005.5      NA 8.9e-01                                                       00002 00015 -3.719826e+02 4.5e-03 0005.5      NA 8.9e-01                                                       00002 00016 -3.719824e+02 3.9e-03 0005.5      NA 8.9e-01                                                       00002 00017 -3.719823e+02 2.8e-03 0005.5      NA 8.9e-01                                                       00002 00018 -3.719823e+02 2.4e-03 0005.6      NA 8.9e-01                                                       00002 00019 -3.719822e+02 1.7e-03 0005.6      NA 8.9e-01                                                       00002 00020 -3.719822e+02 1.4e-03 0005.6      NA 8.9e-01                                                       00002 00021 -3.719822e+02 1.0e-03 0005.6      NA 8.9e-01                                                       00002 00022 -3.719822e+02 8.5e-04 0005.6      NA 8.9e-01                                                       00002 00023 -3.719822e+02 6.1e-04 0005.6      NA 8.9e-01                                                       00002 00024 -3.719822e+02 5.0e-04 0005.6      NA 8.9e-01                                                       00002 00025 -3.719822e+02 3.6e-04 0005.6      NA 8.9e-01                                                       00002 00026 -3.719822e+02 2.9e-04 0005.6      NA 8.9e-01                                                       00002 00027 -3.719822e+02 2.1e-04 0005.6      NA 8.9e-01                                                       00002 00028 -3.719822e+02 1.7e-04 0005.6      NA 8.9e-01                                                       00002 00029 -3.719822e+02 1.2e-04 0005.6      NA 8.9e-01                                                       00002 00030 -3.719822e+02 9.8e-05 0005.6      NA 8.9e-01                                                       00003 00001 -3.839313e+02 9.8e-01 0005.9      NA 3.1e-01                                                       00003 00002 -3.749319e+02 3.6e-01 0008.7      NA 3.2e-01                                                       00003 00003 -3.722280e+02 2.4e-01 0009.4      NA 3.8e-01                                                       00003 00004 -3.708962e+02 9.4e-02 0009.6      NA 4.2e-01                                                       00003 00005 -3.702336e+02 8.0e-02 0009.8      NA 4.6e-01                                                       00003 00006 -3.698805e+02 6.9e-02 0010.0      NA 4.9e-01                                                       00003 00007 -3.696822e+02 5.4e-02 0010.1      NA 5.1e-01                                                       00003 00008 -3.695629e+02 5.7e-02 0010.3      NA 5.2e-01                                                       00003 00009 -3.694880e+02 4.3e-02 0010.4      NA 5.3e-01                                                       00003 00010 -3.694398e+02 4.0e-02 0010.4      NA 5.4e-01                                                       00003 00011 -3.694087e+02 2.7e-02 0010.5      NA 5.5e-01                                                       00003 00012 -3.693890e+02 2.3e-02 0010.6      NA 5.5e-01                                                       00003 00013 -3.693768e+02 1.6e-02 0010.6      NA 5.6e-01                                                       00003 00014 -3.693693e+02 1.2e-02 0010.6      NA 5.6e-01                                                       00003 00015 -3.693648e+02 9.4e-03 0010.6      NA 5.6e-01                                                       00003 00016 -3.693621e+02 6.8e-03 0010.6      NA 5.6e-01                                                       00003 00017 -3.693605e+02 5.3e-03 0010.7      NA 5.7e-01                                                       00003 00018 -3.693596e+02 3.8e-03 0010.7      NA 5.7e-01                                                       00003 00019 -3.693590e+02 3.0e-03 0010.7      NA 5.7e-01                                                       00003 00020 -3.693587e+02 2.2e-03 0010.7      NA 5.7e-01                                                       00003 00021 -3.693585e+02 1.7e-03 0010.7      NA 5.7e-01                                                       00003 00022 -3.693584e+02 1.2e-03 0010.7      NA 5.7e-01                                                       00003 00023 -3.693583e+02 9.6e-04 0010.7      NA 5.7e-01                                                       00003 00024 -3.693583e+02 7.1e-04 0010.7      NA 5.7e-01                                                       00003 00025 -3.693583e+02 5.5e-04 0010.7      NA 5.7e-01                                                       00003 00026 -3.693583e+02 4.1e-04 0010.7      NA 5.7e-01                                                       00003 00027 -3.693583e+02 3.2e-04 0010.7      NA 5.7e-01                                                       00003 00028 -3.693583e+02 2.4e-04 0010.7      NA 5.7e-01                                                       00003 00029 -3.693583e+02 1.8e-04 0010.7      NA 5.7e-01                                                       00003 00030 -3.693583e+02 1.4e-04 0010.7      NA 5.7e-01                                                       00003 00031 -3.693583e+02 1.1e-04 0010.7      NA 5.7e-01                                                       00003 00032 -3.693583e+02 7.9e-05 0010.7      NA 5.7e-01                                                       00004 00001 -3.905427e+02 9.9e-01 0011.1      NA 2.0e-01                                                       00004 00002 -3.764020e+02 3.4e-01 0018.3      NA 1.8e-01                                                       00004 00003 -3.738538e+02 1.3e-01 0019.7      NA 2.0e-01                                                       00004 00004 -3.726080e+02 7.8e-02 0019.8      NA 2.3e-01                                                       00004 00005 -3.718902e+02 7.2e-02 0019.6      NA 2.5e-01                                                       00004 00006 -3.714769e+02 3.9e-02 0019.5      NA 2.8e-01                                                       00004 00007 -3.712422e+02 4.3e-02 0019.4      NA 2.9e-01                                                       00004 00008 -3.711084e+02 2.1e-02 0019.3      NA 3.1e-01                                                       00004 00009 -3.710318e+02 2.4e-02 0019.3      NA 3.2e-01                                                       00004 00010 -3.709879e+02 1.3e-02 0019.2      NA 3.2e-01                                                       00004 00011 -3.709625e+02 1.3e-02 0019.2      NA 3.3e-01                                                       00004 00012 -3.709478e+02 8.2e-03 0019.2      NA 3.3e-01                                                       00004 00013 -3.709393e+02 7.4e-03 0019.2      NA 3.4e-01                                                       00004 00014 -3.709343e+02 5.1e-03 0019.2      NA 3.4e-01                                                       00004 00015 -3.709315e+02 4.2e-03 0019.2      NA 3.4e-01                                                       00004 00016 -3.709298e+02 3.1e-03 0019.2      NA 3.4e-01                                                       00004 00017 -3.709288e+02 2.4e-03 0019.1      NA 3.4e-01                                                       00004 00018 -3.709282e+02 1.9e-03 0019.1      NA 3.5e-01                                                       00004 00019 -3.709279e+02 1.4e-03 0019.1      NA 3.5e-01                                                       00004 00020 -3.709277e+02 1.1e-03 0019.1      NA 3.5e-01                                                       00004 00021 -3.709276e+02 8.5e-04 0019.1      NA 3.5e-01                                                       00004 00022 -3.709275e+02 6.6e-04 0019.1      NA 3.5e-01                                                       00004 00023 -3.709275e+02 5.0e-04 0019.1      NA 3.5e-01                                                       00004 00024 -3.709274e+02 3.9e-04 0019.1      NA 3.5e-01                                                       00004 00025 -3.709274e+02 2.9e-04 0019.1      NA 3.5e-01                                                       00004 00026 -3.709274e+02 2.3e-04 0019.1      NA 3.5e-01                                                       00004 00027 -3.709274e+02 1.7e-04 0019.1      NA 3.5e-01                                                       00004 00028 -3.709274e+02 1.3e-04 0019.1      NA 3.5e-01                                                       00004 00029 -3.709274e+02 1.0e-04 0019.1      NA 3.5e-01                                                       00004 00030 -3.709274e+02 7.9e-05 0019.1      NA 3.5e-01                                                       
#&gt; Computing marginal likelihood for 4 combinations of hyperparameters.
#&gt; -iteration-   variational    max.   incl variance params
#&gt; outer inner   lower bound  change   vars   sigma      sa
#&gt; 00001 00001 -3.785444e+02 4.5e-01 0006.4      NA 8.4e-01                                                       00001 00002 -3.762760e+02 3.4e-01 0005.2      NA 9.9e-01                                                       00001 00003 -3.755333e+02 2.7e-01 0004.6      NA 1.1e+00                                                       00001 00004 -3.754090e+02 8.7e-02 0004.4      NA 1.1e+00                                                       00001 00005 -3.753897e+02 2.4e-02 0004.3      NA 1.1e+00                                                       00001 00006 -3.753811e+02 1.9e-02 0004.3      NA 1.1e+00                                                       00001 00007 -3.753759e+02 1.7e-02 0004.3      NA 1.1e+00                                                       00001 00008 -3.753725e+02 1.4e-02 0004.3      NA 1.1e+00                                                       00001 00009 -3.753700e+02 1.4e-02 0004.3      NA 1.1e+00                                                       00001 00010 -3.753682e+02 1.2e-02 0004.2      NA 1.1e+00                                                       00001 00011 -3.753668e+02 1.1e-02 0004.2      NA 1.1e+00                                                       00001 00012 -3.753656e+02 1.0e-02 0004.2      NA 1.1e+00                                                       00001 00013 -3.753646e+02 1.0e-02 0004.2      NA 1.1e+00                                                       00001 00014 -3.753638e+02 9.5e-03 0004.2      NA 1.1e+00                                                       00001 00015 -3.753630e+02 9.7e-03 0004.2      NA 1.1e+00                                                       00001 00016 -3.753622e+02 9.2e-03 0004.2      NA 1.1e+00                                                       00001 00017 -3.753615e+02 9.5e-03 0004.2      NA 1.1e+00                                                       00001 00018 -3.753609e+02 9.3e-03 0004.2      NA 1.1e+00                                                       00001 00019 -3.753602e+02 9.8e-03 0004.1      NA 1.1e+00                                                       00001 00020 -3.753595e+02 9.8e-03 0004.1      NA 1.1e+00                                                       00001 00021 -3.753587e+02 1.0e-02 0004.1      NA 1.1e+00                                                       00001 00022 -3.753579e+02 1.1e-02 0004.1      NA 1.1e+00                                                       00001 00023 -3.753571e+02 1.2e-02 0004.1      NA 1.1e+00                                                       00001 00024 -3.753562e+02 1.2e-02 0004.1      NA 1.1e+00                                                       00001 00025 -3.753551e+02 1.3e-02 0004.1      NA 1.1e+00                                                       00001 00026 -3.753540e+02 1.4e-02 0004.1      NA 1.1e+00                                                       00001 00027 -3.753526e+02 1.5e-02 0004.0      NA 1.1e+00                                                       00001 00028 -3.753511e+02 1.6e-02 0004.0      NA 1.1e+00                                                       00001 00029 -3.753493e+02 1.8e-02 0004.0      NA 1.1e+00                                                       00001 00030 -3.753472e+02 1.9e-02 0004.0      NA 1.1e+00                                                       00001 00031 -3.753448e+02 2.2e-02 0004.0      NA 1.1e+00                                                       00001 00032 -3.753420e+02 2.3e-02 0003.9      NA 1.1e+00                                                       00001 00033 -3.753389e+02 2.5e-02 0003.9      NA 1.1e+00                                                       00001 00034 -3.753356e+02 2.6e-02 0003.9      NA 1.1e+00                                                       00001 00035 -3.753321e+02 2.7e-02 0003.9      NA 1.1e+00                                                       00001 00036 -3.753285e+02 2.7e-02 0003.8      NA 1.1e+00                                                       00001 00037 -3.753253e+02 2.6e-02 0003.8      NA 1.1e+00                                                       00001 00038 -3.753224e+02 2.4e-02 0003.8      NA 1.1e+00                                                       00001 00039 -3.753201e+02 2.2e-02 0003.7      NA 1.1e+00                                                       00001 00040 -3.753183e+02 1.9e-02 0003.7      NA 1.2e+00                                                       00001 00041 -3.753170e+02 1.6e-02 0003.7      NA 1.2e+00                                                       00001 00042 -3.753162e+02 1.3e-02 0003.7      NA 1.2e+00                                                       00001 00043 -3.753157e+02 1.0e-02 0003.7      NA 1.2e+00                                                       00001 00044 -3.753154e+02 7.7e-03 0003.7      NA 1.2e+00                                                       00001 00045 -3.753152e+02 6.0e-03 0003.7      NA 1.2e+00                                                       00001 00046 -3.753151e+02 4.3e-03 0003.7      NA 1.2e+00                                                       00001 00047 -3.753150e+02 3.3e-03 0003.7      NA 1.2e+00                                                       00001 00048 -3.753150e+02 2.3e-03 0003.7      NA 1.2e+00                                                       00001 00049 -3.753150e+02 1.8e-03 0003.7      NA 1.2e+00                                                       00001 00050 -3.753150e+02 1.2e-03 0003.7      NA 1.2e+00                                                       00001 00051 -3.753150e+02 9.4e-04 0003.7      NA 1.2e+00                                                       00001 00052 -3.753150e+02 6.6e-04 0003.7      NA 1.2e+00                                                       00001 00053 -3.753150e+02 5.0e-04 0003.7      NA 1.2e+00                                                       00001 00054 -3.753150e+02 3.5e-04 0003.7      NA 1.2e+00                                                       00001 00055 -3.753150e+02 2.6e-04 0003.7      NA 1.2e+00                                                       00001 00056 -3.753150e+02 1.8e-04 0003.7      NA 1.2e+00                                                       00001 00057 -3.753150e+02 1.4e-04 0003.7      NA 1.2e+00                                                       00001 00058 -3.753150e+02 9.6e-05 0003.6      NA 1.2e+00                                                       00002 00001 -3.733707e+02 1.8e-01 0008.1      NA 7.2e-01                                                       00002 00002 -3.729088e+02 1.7e-01 0007.5      NA 7.6e-01                                                       00002 00003 -3.725921e+02 1.6e-01 0007.0      NA 7.8e-01                                                       00002 00004 -3.723526e+02 1.4e-01 0006.6      NA 8.1e-01                                                       00002 00005 -3.721988e+02 9.9e-02 0006.2      NA 8.3e-01                                                       00002 00006 -3.721021e+02 1.1e-01 0006.0      NA 8.5e-01                                                       00002 00007 -3.720383e+02 1.1e-01 0005.8      NA 8.7e-01                                                       00002 00008 -3.720029e+02 8.0e-02 0005.7      NA 8.8e-01                                                       00002 00009 -3.719884e+02 5.1e-02 0005.6      NA 8.9e-01                                                       00002 00010 -3.719839e+02 2.6e-02 0005.6      NA 8.9e-01                                                       00002 00011 -3.719827e+02 1.3e-02 0005.6      NA 8.9e-01                                                       00002 00012 -3.719823e+02 5.8e-03 0005.6      NA 8.9e-01                                                       00002 00013 -3.719822e+02 2.9e-03 0005.6      NA 8.9e-01                                                       00002 00014 -3.719822e+02 1.2e-03 0005.6      NA 8.9e-01                                                       00002 00015 -3.719822e+02 6.3e-04 0005.6      NA 8.9e-01                                                       00002 00016 -3.719822e+02 2.6e-04 0005.6      NA 8.9e-01                                                       00002 00017 -3.719822e+02 1.4e-04 0005.6      NA 8.9e-01                                                       00002 00018 -3.719822e+02 5.7e-05 0005.6      NA 8.9e-01                                                       00003 00001 -3.693583e+02 6.1e-05 0010.7      NA 5.7e-01                                                       00004 00001 -3.719628e+02 2.8e-01 0016.3      NA 4.0e-01                                                       00004 00002 -3.711366e+02 1.5e-01 0018.0      NA 3.6e-01                                                       00004 00003 -3.710003e+02 9.8e-02 0018.6      NA 3.5e-01                                                       00004 00004 -3.709555e+02 5.4e-02 0018.9      NA 3.5e-01                                                       00004 00005 -3.709387e+02 3.4e-02 0019.0      NA 3.5e-01                                                       00004 00006 -3.709320e+02 1.8e-02 0019.1      NA 3.5e-01                                                       00004 00007 -3.709294e+02 1.1e-02 0019.1      NA 3.5e-01                                                       00004 00008 -3.709283e+02 6.1e-03 0019.1      NA 3.5e-01                                                       00004 00009 -3.709278e+02 4.2e-03 0019.1      NA 3.5e-01                                                       00004 00010 -3.709276e+02 2.5e-03 0019.1      NA 3.5e-01                                                       00004 00011 -3.709275e+02 1.6e-03 0019.1      NA 3.5e-01                                                       00004 00012 -3.709275e+02 1.1e-03 0019.1      NA 3.5e-01                                                       00004 00013 -3.709274e+02 6.9e-04 0019.1      NA 3.5e-01                                                       00004 00014 -3.709274e+02 5.1e-04 0019.1      NA 3.5e-01                                                       00004 00015 -3.709274e+02 3.2e-04 0019.1      NA 3.5e-01                                                       00004 00016 -3.709274e+02 2.5e-04 0019.1      NA 3.5e-01                                                       00004 00017 -3.709274e+02 1.6e-04 0019.1      NA 3.5e-01                                                       00004 00018 -3.709274e+02 1.3e-04 0019.1      NA 3.5e-01                                                       00004 00019 -3.709274e+02 8.1e-05 0019.1      NA 3.5e-01                                                       </div><div class='input'><span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='no'>fit</span>))</div><div class='output co'>#&gt; Summary of fitted Bayesian variable selection model:
#&gt; family:     binomial   num. hyperparameter settings: 4
#&gt; samples:    750        iid variable selection prior: yes
#&gt; variables:  100        fit prior var. of coefs (sa): yes
#&gt; covariates: 3          fit approx. factors (eta):    yes
#&gt; maximum log-likelihood lower bound: -369.3583
#&gt; Hyperparameters: 
#&gt;         estimate Pr&gt;0.95             candidate values
#&gt; sa         0.555 [0.348,0.889]       NA--NA
#&gt; logodds    -0.95 [-1.50,-0.50]       (-2.00)--(-0.50)
#&gt; Selected variables by probability cutoff:
#&gt; &gt;0.10 &gt;0.25 &gt;0.50 &gt;0.75 &gt;0.90 &gt;0.95 
#&gt;    13    10     8     8     5     4 
#&gt; Top 5 variables by inclusion probability:
#&gt;   index variable  prob PVE  coef*  Pr(coef.&gt;0.95)
#&gt; 1     4       X4 1.000  NA -1.492 [-1.771,-1.181]
#&gt; 2     8       X8 1.000  NA  1.219 [+0.954,+1.484]
#&gt; 3     2       X2 1.000  NA -0.749 [-1.020,-0.468]
#&gt; 4     9       X9 0.997  NA  0.664 [+0.399,+0.935]
#&gt; 5    10      X10 0.923  NA  0.449 [+0.222,+0.681]
#&gt; *See help(varbvs) about interpreting coefficients in logistic regression.</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#regression-models">Regression models</a></li>

      <li><a href="#co-ordinate-ascent-optimization-procedure">Co-ordinate ascent optimization procedure</a></li>

      <li><a href="#variational-approximation">Variational approximation</a></li>

      <li><a href="#averaging-over-hyperparameter-settings">Averaging over hyperparameter settings</a></li>

      <li><a href="#prior-on-proportion-of-variance-explained">Prior on proportion of variance explained</a></li>

      <li><a href="#memory-requirements">Memory requirements</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Peter Carbonetto <a href='mailto:peter.carbonetto@gmail.com'>peter.carbonetto@gmail.com</a>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Peter Carbonetto, Matthew Stephens, David Gerard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
